[Unit]
Description=Nginx Prometheus Exporter
Documentation=https://github.com/nginxinc/nginx-prometheus-exporter
After=network.target nginx.service

[Service]
Type=simple
User={{ node_exporter_service_user }}
Group={{ node_exporter_service_group }}
ExecStart={{ node_exporter_install_dir }}/nginx-prometheus-exporter \
  -nginx.scrape-uri {{ node_exporter_nginx_stub_status_url }} \
  -web.listen-address {{ node_exporter_nginx_exporter_listen_address }}

SyslogIdentifier=nginx_exporter
Restart=always
RestartSec=5s

# Security hardening
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=true
PrivateTmp=true
ProtectKernelTunables=true
ProtectKernelModules=true
ProtectControlGroups=true
RestrictRealtime=true
RestrictNamespaces=true
RestrictAddressFamilies=AF_INET AF_INET6

[Install]
WantedBy=multi-user.target
